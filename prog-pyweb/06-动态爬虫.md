# 动态爬虫

## 1. 动态采集

### 1.1. 常用 JavaScript 库

用 Python 执行 JavaScript 代码的效率非常低，尤其是在处理规模较大的 JavaScript 代码时。若有绕过 JavaScript 并直接解析它的方法（不需要执行它就可获得信息）会非常实用。

- jQuery

若在一个网站上看到了 jQuery，则采集这个网站数据的时候要格外小心。jQuery 可动态地创建 HTML 内容，只有在 JavaScript 代码执行之后才会显示。若用传统的方法采集页面内容，就只能获得 JavaScript 代码执行之前页面上的内容。

另外，这些页面还可能包含动画、用户交互内容和嵌入式媒体，这些内容对网络数据采集均是挑战。

- Google Analytics

有一半的网站都在用 Google Analytics，它可能是网站最常用的 JavaScript 库和最受欢迎的用户跟踪工具。

若网站使用了 Google Analytics，在页面底部会有类似如下所示的 JavaScript 代码：

```html
<!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-4591498-1"]);
  _gaq.push(["_setDomainName", "oreilly.com"]);
  _gaq.push(["_addIgnoredRef", "oreilly.com"]);
  _gaq.push(["_setSiteSpeedSampleRate", 50]);
  _gaq.push(["_trackPageview"]);

  (function () {
    var ga = document.createElement("script");
    ga.type = "text/javascript";
    ga.async = true;
    ga.src =
      ("https:" == document.location.protocol ? "https://ssl" : "http://www") +
      ".google-analytics.com/ga.js";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ga, s);
  })();
</script>
```

若一个网站使用了 Google Analytics 或其他类似的网络分析系统，而你不想让网站知道你在采集数据，就要确保把那些分析工具的 cookie 或者所有 cookie 都关掉。
